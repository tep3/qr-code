<!doctype html>
<html lang="en" data-theme="silk">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
    />
    <title>QR Forge ‚Äî {{title}}</title>

    <link
      rel="icon"
      href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2280%22>‚öíÔ∏è</text></svg>"
      type="image/svg+xml"
    />

    <!-- PWA / Service Worker -->
    <!-- <link rel="manifest" href="/manifest.json" />
    <script>
      if ("serviceWorker" in navigator) {
        window.addEventListener("load", () => {
          navigator.serviceWorker
            .register("/sw.js")
            .then((registration) => {
              console.log("ServiceWorker registration successful");
            })
            .catch((err) => {
              console.log("ServiceWorker registration failed: ", err);
            });
        });
      }
    </script> -->

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=DM+Serif+Display&family=Outfit:wght@300;400;500;600;700&family=Space+Mono:wght@400;700&family=Noto+Sans+Thai:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <!-- Tailwind + DaisyUI -->
    <link
      href="https://cdn.jsdelivr.net/npm/daisyui@4.12.10/dist/full.min.css"
      rel="stylesheet"
      type="text/css"
    />
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              sans: ["Outfit", "Noto Sans Thai", "sans-serif"],
              serif: ["DM Serif Display", "Noto Sans Thai", "serif"],
              mono: ["Space Mono", "monospace"],
            },
          },
        },
      };
    </script>

    <!-- HTMX -->
    <script
      src="https://cdn.jsdelivr.net/npm/htmx.org@2.0.8/dist/htmx.min.js"
      crossorigin="anonymous"
    ></script>

    <!-- i18n Script -->
    <script>
      (function () {
        const translations = {
          en: {
            nav_generate: "Generate",
            nav_scan: "Scan",
            nav_history: "History",
            footer_desc: "Free & Open QR Tool",
            footer_sub: "No accounts ¬∑ No tracking ¬∑ 100% free",

            // Home
            home_badge: "Free ¬∑ No signup ¬∑ Works offline",
            home_title_pre: "Craft your",
            home_title_post: "QR Code",
            home_desc:
              "Generate beautiful QR codes for links, WiFi, contacts and more ‚Äî in seconds.",
            label_encode: "What do you want to encode?",
            tab_url: "URL",
            tab_text: "Text",
            tab_wifi: "WiFi",
            tab_vcard: "vCard",
            tab_email: "Email",
            tab_phone: "Phone",
            tab_sms: "SMS",
            tab_line: "LINE",
            tab_facebook: "Facebook",
            tab_promptpay: "PromptPay",
            label_promptpay_id: "PromptPay ID",
            ph_promptpay_id: "08X-XXX-XXXX or Tax ID",
            help_promptpay_id: "Mobile number or Tax ID / E-Wallet ID",
            label_promptpay_amount: "Amount (Optional)",
            help_promptpay_amount:
              "Leave empty for transfer without fixed amount",
            promptpay_currency: "THB",
            promptpay_formats_title: "Supported ID formats:",
            promptpay_fmt_mobile:
              'Mobile: <span class="font-mono">08X-XXX-XXXX</span>',
            promptpay_fmt_natid:
              'National ID: <span class="font-mono">X-XXXX-XXXXX-XX-X</span> (13 digits)',
            promptpay_fmt_taxid:
              'Tax ID: <span class="font-mono">XXXXXXXXXXXXX</span> (13 digits)',
            label_content: "Content",
            label_website_url: "Website URL",
            ph_website_url: "https://example.com",
            help_website_url: "Enter the full URL including https://",
            summary_style: "Customize Style",
            summary_style_desc: "Colors, size, label, logo & more",
            btn_generate: "Generate QR Code",

            // Style Options
            style_fg: "Foreground",
            style_bg: "Background",
            style_dot: "Dot Style",
            style_ec: "Error Correction",
            style_size: "Size",
            style_margin: "Margin",
            style_quiet_zone: "Quiet zone:",
            style_modules: "modules",
            label_text_opt: "Label Text (Optional)",
            label_size: "Size",
            label_pos: "Position",
            label_pos_top: "Top",
            label_pos_bottom: "Bottom",
            label_color: "Text Color",
            label_color_help: "Matches QR color by default",
            border_frame: "Border / Frame",
            border_color: "Border Color",

            // Preview
            preview_title: "Preview",
            preview_placeholder: "Your QR code will appear here",
            preview_help: "Fill in the content and hit Generate",
            badge_private: "Private",
            badge_instant: "Instant",
            badge_free: "100% Free",

            // Scan
            scan_badge: "AI Powered & Secure",
            scan_title: "Scan",
            scan_desc:
              "Point your camera at a QR code or upload an image to decode instantly.",
            camera_access: "Camera Access",
            camera_start_help: "Click below to start scanning via your webcam.",
            btn_start_camera: "Start Camera",
            or_upload: "OR Upload Image",
            upload_help: "Click to upload",
            upload_help_sub: "or drag and drop",
            scan_success: "Success!",
            scan_success_desc: "Content successfully decoded.",
            result_content: "Result Content",
            btn_copy: "Copy Content",
            btn_open: "Open Link",
            btn_back_scan: "Back to Scanner",
            scan_footer:
              "Secure Client-Side Processing. No data is sent to servers.",
            copied: "Copied!",
            err_no_qr:
              "No QR code found in this image. Please try another one.",

            // History
            history_title: "History",
            history_desc:
              "Your recently generated QR codes (saved locally on your device)",
            btn_clear_all: "Clear All",
            empty_title: "No QR Codes Yet",
            empty_desc:
              "You haven't generated any QR codes. Head back to the home page to create your first one!",
            btn_create_first: "Create QR Code",
            confirm_delete:
              "Are you sure you want to delete this QR code from history?",
            confirm_clear:
              "Are you sure you want to clear ALL history? This cannot be undone.",
            btn_save_history: "Save to History",
            saved: "Saved!",
          },
          th: {
            nav_generate: "‡∏™‡∏£‡πâ‡∏≤‡∏á QR",
            nav_scan: "‡∏™‡πÅ‡∏Å‡∏ô",
            nav_history: "‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥",
            footer_desc: "‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠ QR ‡∏ü‡∏£‡∏µ & ‡πÇ‡∏≠‡πÄ‡∏û‡∏ô‡∏ã‡∏≠‡∏£‡πå‡∏™",
            footer_sub: "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ ¬∑ ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏° ¬∑ ‡∏ü‡∏£‡∏µ 100%",

            // Home
            home_badge: "‡∏ü‡∏£‡∏µ ¬∑ ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏°‡∏±‡∏Ñ‡∏£ ¬∑ ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏≠‡∏≠‡∏ü‡πÑ‡∏•‡∏ô‡πå‡πÑ‡∏î‡πâ",
            home_title_pre: "‡∏™‡∏£‡πâ‡∏≤‡∏á",
            home_title_post: "QR Code",
            home_desc:
              "‡∏™‡∏£‡πâ‡∏≤‡∏á QR Code ‡∏ó‡∏µ‡πà‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏•‡∏¥‡∏á‡∏Å‡πå, WiFi, ‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ ‡πÅ‡∏•‡∏∞‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‚Äî ‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡πÑ‡∏°‡πà‡∏Å‡∏µ‡πà‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ",
            label_encode: "‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á QR ‡∏à‡∏≤‡∏Å‡∏≠‡∏∞‡πÑ‡∏£?",
            tab_url: "‡∏•‡∏¥‡∏á‡∏Å‡πå",
            tab_text: "‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°",
            tab_wifi: "WiFi",
            tab_vcard: "‡∏ô‡∏≤‡∏°‡∏ö‡∏±‡∏ï‡∏£",
            tab_email: "‡∏≠‡∏µ‡πÄ‡∏°‡∏•",
            tab_phone: "‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå",
            tab_sms: "SMS",
            tab_line: "LINE",
            tab_facebook: "Facebook",
            tab_promptpay: "PromptPay",
            label_promptpay_id: "‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç PromptPay",
            ph_promptpay_id: "08X-XXX-XXXX ‡∏´‡∏£‡∏∑‡∏≠ ‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏†‡∏≤‡∏©‡∏µ",
            help_promptpay_id:
              "‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠, ‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏†‡∏≤‡∏©‡∏µ ‡∏´‡∏£‡∏∑‡∏≠ E-Wallet",
            label_promptpay_amount: "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)",
            help_promptpay_amount: "‡πÄ‡∏ß‡πâ‡∏ô‡∏ß‡πà‡∏≤‡∏á‡πÑ‡∏ß‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏≥‡∏ô‡∏ß‡∏ô",
            promptpay_currency: "‡∏ö‡∏≤‡∏ó",
            promptpay_formats_title: "‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö ID ‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö:",
            promptpay_fmt_mobile:
              '‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠: <span class="font-mono">08X-XXX-XXXX</span>',
            promptpay_fmt_natid:
              '‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô: <span class="font-mono">X-XXXX-XXXXX-XX-X</span> (13 ‡∏´‡∏•‡∏±‡∏Å)',
            promptpay_fmt_taxid:
              '‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏†‡∏≤‡∏©‡∏µ: <span class="font-mono">XXXXXXXXXXXXX</span> (13 ‡∏´‡∏•‡∏±‡∏Å)',
            label_content: "‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤",
            label_website_url: "‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå",
            ph_website_url: "https://example.com",
            help_website_url: "‡πÉ‡∏™‡πà URL ‡πÄ‡∏ï‡πá‡∏°‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏£‡∏ß‡∏°‡∏ñ‡∏∂‡∏á https://",
            summary_style: "‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡∏™‡πÑ‡∏ï‡∏•‡πå",
            summary_style_desc: "‡∏™‡∏µ, ‡∏Ç‡∏ô‡∏≤‡∏î, ‡πÇ‡∏•‡πÇ‡∏Å‡πâ ‡πÅ‡∏•‡∏∞‡∏≠‡∏∑‡πà‡∏ô‡πÜ",
            btn_generate: "‡∏™‡∏£‡πâ‡∏≤‡∏á QR Code",

            // Style Options
            style_fg: "‡∏™‡∏µ‡∏´‡∏•‡∏±‡∏Å",
            style_bg: "‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á",
            style_dot: "‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏à‡∏∏‡∏î",
            style_ec: "‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î",
            style_size: "‡∏Ç‡∏ô‡∏≤‡∏î",
            style_margin: "‡∏Ç‡∏≠‡∏ö‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á",
            style_quiet_zone: "‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡πà‡∏≤‡∏á:",
            style_modules: "‡∏´‡∏ô‡πà‡∏ß‡∏¢",
            label_text_opt: "‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ö‡∏ô QR (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)",
            label_size: "‡∏Ç‡∏ô‡∏≤‡∏î",
            label_pos: "‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á",
            label_pos_top: "‡∏ö‡∏ô",
            label_pos_bottom: "‡∏•‡πà‡∏≤‡∏á",
            label_color: "‡∏™‡∏µ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°",
            label_color_help: "‡πÉ‡∏ä‡πâ‡∏™‡∏µ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö QR ‡πÇ‡∏î‡∏¢‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô",
            border_frame: "‡∏Å‡∏£‡∏≠‡∏ö / ‡πÄ‡∏ü‡∏£‡∏°",
            border_color: "‡∏™‡∏µ‡∏Å‡∏£‡∏≠‡∏ö",

            // Preview
            preview_title: "‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á",
            preview_placeholder: "QR Code ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà",
            preview_help: "‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á",
            badge_private: "‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß",
            badge_instant: "‡∏ó‡∏±‡∏ô‡∏ó‡∏µ",
            badge_free: "‡∏ü‡∏£‡∏µ 100%",

            // Scan
            scan_badge: "‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ & ‡πÉ‡∏ä‡πâ AI",
            scan_title: "‡∏™‡πÅ‡∏Å‡∏ô",
            scan_desc:
              "‡∏™‡πà‡∏≠‡∏á‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÑ‡∏õ‡∏ó‡∏µ‡πà QR code ‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤‡∏ó‡∏±‡∏ô‡∏ó‡∏µ",
            camera_access: "‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏Å‡∏•‡πâ‡∏≠‡∏á",
            camera_start_help: "‡∏Ñ‡∏•‡∏¥‡∏Å‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡πÅ‡∏Å‡∏ô‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏•‡πâ‡∏≠‡∏á",
            btn_start_camera: "‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á",
            or_upload: "‡∏´‡∏£‡∏∑‡∏≠ ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û",
            upload_help: "‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î",
            upload_help_sub: "‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏≤‡∏ß‡∏≤‡∏á",
            scan_success: "‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!",
            scan_success_desc: "‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß",
            result_content: "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ",
            btn_copy: "‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•",
            btn_open: "‡πÄ‡∏õ‡∏¥‡∏î‡∏•‡∏¥‡∏á‡∏Å‡πå",
            btn_back_scan: "‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏™‡πÅ‡∏Å‡∏ô",
            scan_footer:
              "‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏ö‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏∂‡πâ‡∏ô Server",
            copied: "‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß!",
            err_no_qr: "‡πÑ‡∏°‡πà‡∏û‡∏ö QR code ‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏ô‡∏µ‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á",

            // History
            history_title: "‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥",
            history_desc: "QR codes ‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î (‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì)",
            btn_clear_all: "‡∏•‡πâ‡∏≤‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î",
            empty_title: "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥",
            empty_desc:
              "‡∏Ñ‡∏∏‡∏ì‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á QR code ‡πÄ‡∏•‡∏¢ ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á!",
            btn_create_first: "‡∏™‡∏£‡πâ‡∏≤‡∏á QR Code",
            confirm_delete: "‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö QR code ‡∏ô‡∏µ‡πâ‡∏à‡∏≤‡∏Å‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥?",
            confirm_clear:
              "‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î? ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏î‡πâ",
            btn_save_history: "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥",
            saved: "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡πâ‡∏ß!",
          },
        };

        window.t = function (key) {
          const lang = localStorage.getItem("qrforge_lang") || "en";
          return translations[lang][key] || key;
        };

        window.currentLang = function () {
          return localStorage.getItem("qrforge_lang") || "en";
        };

        window.setLanguage = function (lang) {
          localStorage.setItem("qrforge_lang", lang);
          updatePageContent();
          updateLanguageUI();

          // Close all DaisyUI tabindex dropdowns (fix for iOS/WKWebView)
          document
            .querySelectorAll(".dropdown-content")
            .forEach(function (menu) {
              menu.blur();
              menu.closest(".dropdown")?.querySelector("[tabindex]")?.blur();
            });
          if (document.activeElement) document.activeElement.blur();
        };

        function updatePageContent() {
          const lang = window.currentLang();
          const data = translations[lang];

          // 1. Update elements with data-i18n (Static content)
          document.querySelectorAll("[data-i18n]").forEach((el) => {
            const key = el.getAttribute("data-i18n");
            if (data[key]) {
              if (el.tagName === "INPUT" && el.getAttribute("placeholder")) {
                el.placeholder = data[key];
              } else if (data[key].includes("<")) {
                el.innerHTML = data[key];
              } else {
                el.innerText = data[key];
              }
            }
          });

          // 1b. Update placeholders via data-i18n-ph
          document.querySelectorAll("[data-i18n-ph]").forEach((el) => {
            const key = el.getAttribute("data-i18n-ph");
            if (data[key]) {
              el.placeholder = data[key];
            }
          });

          // 2. Dynamic Fallbacks (Best effort for dynamic forms/labels)
          if (lang === "th") {
            const dynamicMaps = {
              "Network Name (SSID)": "‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢ (SSID)",
              Password: "‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô",
              Encryption: "‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™",
              "Hidden Network": "‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢‡∏ã‡πà‡∏≠‡∏ô",
              "First Name": "‡∏ä‡∏∑‡πà‡∏≠‡∏à‡∏£‡∏¥‡∏á",
              "Last Name": "‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•",
              Organization: "‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£",
              "Job Title": "‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏á‡∏≤‡∏ô",
              "Mobile Phone": "‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠",
              "Work Phone": "‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô",
              Email: "‡∏≠‡∏µ‡πÄ‡∏°‡∏•",
              Website: "‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå",
              Street: "‡∏ñ‡∏ô‡∏ô/‡∏ã‡∏≠‡∏¢",
              City: "‡πÄ‡∏°‡∏∑‡∏≠‡∏á/‡πÄ‡∏Ç‡∏ï",
              Zipcode: "‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå",
              Country: "‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®",
              Subject: "‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠",
              Message: "‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°",
              "Phone Number": "‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå",
              "Facebook URL": "‡∏•‡∏¥‡∏á‡∏Å‡πå Facebook",
              "Enter text": "‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°",
              "Enter phone number": "‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå",
              "PromptPay ID": "‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç PromptPay",
              "Amount (Optional)": "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)",
              "Mobile number, National ID, or Tax ID":
                "‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠, ‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß ‡∏´‡∏£‡∏∑‡∏≠ ‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏†‡∏≤‡∏©‡∏µ",
              "Mobile number or Tax ID / E-Wallet ID":
                "‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠, ‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏†‡∏≤‡∏©‡∏µ ‡∏´‡∏£‡∏∑‡∏≠ E-Wallet",
              "Leave empty for transfer without fixed amount":
                "‡πÄ‡∏ß‡πâ‡∏ô‡∏ß‡πà‡∏≤‡∏á‡πÑ‡∏ß‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏≥‡∏ô‡∏ß‡∏ô",
              "08X-XXX-XXXX or 1-XXXX-XXXXX-XX-X":
                "08X-XXX-XXXX ‡∏´‡∏£‡∏∑‡∏≠ ‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏†‡∏≤‡∏©‡∏µ",
              "08X-XXX-XXXX or Tax ID":
                "08X-XXX-XXXX ‡∏´‡∏£‡∏∑‡∏≠ ‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏†‡∏≤‡∏©‡∏µ",
              "Enter email": "‡∏Å‡∏£‡∏≠‡∏Å‡∏≠‡∏µ‡πÄ‡∏°‡∏•",
              THB: "‡∏ö‡∏≤‡∏ó",
            };

            // Translate Labels
            document
              .querySelectorAll(
                "label span.label-text, span.label-text-alt, option",
              )
              .forEach((el) => {
                const txt = el.innerText.trim();
                if (dynamicMaps[txt]) el.innerText = dynamicMaps[txt];
              });

            // Translate Placeholders
            document
              .querySelectorAll("input[placeholder], textarea[placeholder]")
              .forEach((el) => {
                const ph = el.getAttribute("placeholder");
                if (ph && dynamicMaps[ph])
                  el.setAttribute("placeholder", dynamicMaps[ph]);
              });
          }
        }

        function updateLanguageUI() {
          const lang = window.currentLang();
          // Update Icons / Text in Dropdown Button
          const desktopIcon = document.getElementById("lang-icon-desktop");
          if (desktopIcon) desktopIcon.innerText = lang === "en" ? "üá¨üáß" : "üáπüá≠";

          const mobileIcon = document.getElementById("lang-icon-mobile");
          if (mobileIcon) mobileIcon.innerText = lang === "en" ? "üá¨üáß" : "üáπüá≠";
        }

        // Initialize on load
        document.addEventListener("DOMContentLoaded", () => {
          updatePageContent();
          updateLanguageUI();
        });

        // Re-run on HTMX swaps (This is the key fix for navigation)
        // htmx:afterSwap ensures content is in DOM before we try to translate it
        // FIXED: ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å document.body ‡πÄ‡∏õ‡πá‡∏ô document ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô TypeError ‡∏ï‡∏≠‡∏ô‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å
        document.addEventListener("htmx:afterSwap", () => {
          updatePageContent();
        });
      })();
    </script>

    <style>
      .nav-link {
        position: relative;
        transition: color 0.2s ease;
      }
      .nav-link::after {
        content: "";
        position: absolute;
        bottom: -4px;
        left: 50%;
        width: 0;
        height: 2px;
        background: oklch(var(--p));
        border-radius: 1px;
        transition:
          width 0.25s ease,
          left 0.25s ease;
      }
      .nav-link:hover::after,
      .nav-link.active::after {
        width: 100%;
        left: 0;
      }
      .nav-link:hover,
      .nav-link.active {
        color: oklch(var(--p));
      }

      .htmx-indicator {
        display: none;
      }
      .htmx-request .htmx-indicator,
      .htmx-request.htmx-indicator {
        display: inline-flex;
      }

      @keyframes fadeUp {
        from {
          opacity: 0;
          transform: translateY(16px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      .animate-fade-up {
        animation: fadeUp 0.5s ease-out both;
      }
      .delay-1 {
        animation-delay: 0.08s;
      }
      .delay-2 {
        animation-delay: 0.16s;
      }
      .delay-3 {
        animation-delay: 0.24s;
      }
      .delay-4 {
        animation-delay: 0.32s;
      }
      #form-fields > * {
        animation: fadeUp 0.2s ease-out both;
      }
    </style>

    <link rel="stylesheet" href="/css/custom.css" />
  </head>

  <body class="min-h-screen font-sans bg-base-100 text-base-content">
    <!-- NAVBAR -->
    <nav
      class="sticky top-0 z-50 bg-base-100/80 backdrop-blur-lg border-b border-base-200"
      style="padding-top: env(safe-area-inset-top, 0px)"
    >
      <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex items-center justify-between h-16">
          <a
            href="/"
            hx-get="/"
            hx-select="#main-content"
            hx-target="#main-content"
            hx-push-url="true"
            class="flex items-center gap-2.5 group"
          >
            <span
              class="text-2xl transition-transform group-hover:rotate-12 duration-300"
              >‚öíÔ∏è</span
            >
            <span class="text-xl font-serif tracking-tight">
              <span class="text-primary">QR</span> Forge
            </span>
          </a>

          <!-- Desktop Links -->
          <div class="hidden sm:flex items-center gap-6">
            <a
              href="/"
              hx-get="/"
              hx-select="#main-content"
              hx-target="#main-content"
              hx-push-url="true"
              class="nav-link text-sm font-medium {{navGenerate}}"
              data-i18n="nav_generate"
              >Generate</a
            >
            <a
              href="/scan"
              hx-get="/scan"
              hx-select="#main-content"
              hx-target="#main-content"
              hx-push-url="true"
              class="nav-link text-sm font-medium {{navScan}}"
              data-i18n="nav_scan"
              >Scan</a
            >
            <a
              href="/history"
              hx-get="/history"
              hx-select="#main-content"
              hx-target="#main-content"
              hx-push-url="true"
              class="nav-link text-sm font-medium {{navHistory}}"
            >
              <span data-i18n="nav_history">History</span>
              <span
                id="history-badge"
                class="ml-1 badge badge-xs badge-primary font-bold hidden"
              ></span>
            </a>

            <!-- Modern Language Switcher (Desktop) -->
            <div class="dropdown dropdown-end ml-2">
              <div
                tabindex="0"
                role="button"
                class="btn btn-ghost btn-circle btn-sm border border-base-200/50 hover:bg-base-200"
              >
                <span id="lang-icon-desktop" class="text-lg">üá¨üáß</span>
              </div>
              <ul
                tabindex="0"
                class="dropdown-content z-[1] menu p-2 shadow-lg bg-base-100 rounded-box w-40 mt-2 border border-base-200"
              >
                <li>
                  <a onclick="setLanguage('en')" class="gap-3"
                    ><span class="text-lg">üá¨üáß</span> English</a
                  >
                </li>
                <li>
                  <a onclick="setLanguage('th')" class="gap-3"
                    ><span class="text-lg">üáπüá≠</span> ‡πÑ‡∏ó‡∏¢</a
                  >
                </li>
              </ul>
            </div>
          </div>

          <!-- Mobile Toggle & Lang -->
          <div class="sm:hidden flex items-center gap-2">
            <!-- Modern Language Switcher (Mobile) -->
            <div class="dropdown dropdown-end">
              <div
                tabindex="0"
                role="button"
                class="btn btn-ghost btn-circle btn-xs border border-base-200/50"
              >
                <span id="lang-icon-mobile" class="text-base">üá¨üáß</span>
              </div>
              <ul
                tabindex="0"
                class="dropdown-content z-[1] menu p-2 shadow-lg bg-base-100 rounded-box w-36 mt-2 border border-base-200"
              >
                <li>
                  <a onclick="setLanguage('en')" class="gap-3">üá¨üáß English</a>
                </li>
                <li><a onclick="setLanguage('th')" class="gap-3">üáπüá≠ ‡πÑ‡∏ó‡∏¢</a></li>
              </ul>
            </div>

            <button
              onclick="
                document
                  .getElementById('mobile-menu')
                  .classList.toggle('hidden')
              "
              class="btn btn-ghost btn-sm btn-square"
            >
              <svg
                class="w-5 h-5"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M4 6h16M4 12h16M4 18h16"
                />
              </svg>
            </button>
          </div>
        </div>
      </div>

      <!-- Mobile Menu Links -->
      <div
        id="mobile-menu"
        class="hidden sm:hidden bg-base-100 border-t border-base-200"
      >
        <div class="px-4 py-3 space-y-1">
          <a
            href="/"
            hx-get="/"
            hx-select="#main-content"
            hx-target="#main-content"
            hx-push-url="true"
            onclick="
              document.getElementById('mobile-menu').classList.add('hidden')
            "
            class="mobile-nav-link block px-3 py-2.5 rounded-lg text-sm font-medium hover:bg-base-200 {{navGenerate}}"
            >üé® <span data-i18n="nav_generate">Generate</span></a
          >
          <a
            href="/scan"
            hx-get="/scan"
            hx-select="#main-content"
            hx-target="#main-content"
            hx-push-url="true"
            onclick="
              document.getElementById('mobile-menu').classList.add('hidden')
            "
            class="mobile-nav-link block px-3 py-2.5 rounded-lg text-sm font-medium hover:bg-base-200 {{navScan}}"
            >üì∑ <span data-i18n="nav_scan">Scan</span></a
          >
          <a
            href="/history"
            hx-get="/history"
            hx-select="#main-content"
            hx-target="#main-content"
            hx-push-url="true"
            onclick="
              document.getElementById('mobile-menu').classList.add('hidden')
            "
            class="mobile-nav-link block px-3 py-2.5 rounded-lg text-sm font-medium hover:bg-base-200 {{navHistory}}"
          >
            üìã <span data-i18n="nav_history">History</span>
            <span
              id="history-badge-mobile"
              class="ml-1 badge badge-xs badge-primary font-bold hidden"
            ></span>
          </a>
        </div>
      </div>
    </nav>

    <!-- MAIN -->
    <main id="main-content" class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
      {{content}}
    </main>

    <!-- FOOTER -->
    <footer class="border-t border-base-200 mt-20">
      <div
        class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8 flex flex-col sm:flex-row items-center justify-between gap-4 text-sm text-base-content/40"
      >
        <p>
          <span class="font-serif text-base-content/60">QR Forge</span> ‚Äî
          <span data-i18n="footer_desc">Free & Open QR Tool</span>
        </p>
        <p class="font-mono text-xs tracking-wide" data-i18n="footer_sub">
          No accounts ¬∑ No tracking ¬∑ 100% free
        </p>
      </div>
    </footer>

    <script>
      (function () {
        // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏ï‡∏≠‡∏ô‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å
        try {
          var h = JSON.parse(localStorage.getItem("qrforge_history") || "[]");
          if (h.length > 0) {
            ["history-badge", "history-badge-mobile"].forEach(function (id) {
              var el = document.getElementById(id);
              if (el) {
                el.textContent = h.length;
                el.classList.remove("hidden");
              }
            });
          }
        } catch (e) {}
      })();

      // Use document instead of document.body to prevent null reference errors
      document.addEventListener("htmx:afterSwap", function (event) {
        if (event.detail.target.id === "main-content") {
          const path = window.location.pathname;

          // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ç‡∏≠‡∏á‡πÄ‡∏°‡∏ô‡∏π Desktop
          document.querySelectorAll(".nav-link").forEach((link) => {
            if (link.getAttribute("href") === path) {
              link.classList.add("active");
            } else {
              link.classList.remove("active");
            }
          });

          // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ç‡∏≠‡∏á‡πÄ‡∏°‡∏ô‡∏π Mobile
          document.querySelectorAll(".mobile-nav-link").forEach((link) => {
            if (link.getAttribute("href") === path) {
              link.classList.add("bg-base-200");
            } else {
              link.classList.remove("bg-base-200");
            }
          });
        }
      });
    </script>
    <script src="/js/app.js" defer></script>
  </body>
</html>
